---
title: "Examining Global Refugee Trends and Correlations Over the Years"
subtitle: "INFO 526 - Project 1"
author: 
  - name: "Datatude Dynamos - Ayesha Khatun"
    affiliations:
      - name: "School of Information, University of Arizona"
description: "Analyzing the Effects of External Circumstances on Refugee Movements Between 2010 and 2022"
format:
   html:
    code-tools: true
    code-overflow: wrap
    embed-resources: true
editor: visual
execute:
  warning: false
  echo: false
---

```{r load_packages, message=FALSE, include=FALSE}
# GETTING THE LIBRARIES
if (!require(pacman))
  install.packages(pacman)


pacman::p_load(tidyverse,
               gridExtra,
               tidytuesdayR,
               dplyr,
               janitor,
               dlookr,        # Exploratory data analysis
               here,          # Standardizes paths to data
               formattable,
               ggpubr,
               maps,
               plotly,
               gganimate,
               imager,
               magick,
               gifski,
               ggplot2,
               readr)
```

```{r ggplot_setup, message=FALSE, include=FALSE}
# setting theme for ggplot2
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 14, base_family = "sans"))

# setting width of code output
options(width = 65)

# setting figure parameters for knitr
knitr::opts_chunk$set(
  fig.width = 8,        # 8" width
  fig.asp = 0.618,      # the golden ratio
  fig.retina = 1,       # dpi multiplier for displaying HTML output on retina
  fig.align = "center", # center align figures
  dpi = 140             # higher dpi, sharper image
)
```

```{r load_dataset, message=FALSE, include=FALSE}

# Getting all the underlying data in the dataset
population_data <- read_csv('data/population.csv') 
forest        <- read.csv(here("data", "forest.csv"))
forest_area   <- read.csv(here("data", "forest_area.csv"))
brazil_loss   <- read.csv(here("data", "brazil_loss.csv"))
soybean_use   <- read.csv(here("data", "soybean_use.csv"))
vegetable_oil <- read.csv(here("data", "vegetable_oil.csv"))
total_forest  <- read.csv(here("data", "forest-area-km.csv"))
deforestation_by_source <- read.csv(here("data", "deforestation_by_source.csv"))
```

## Abstract

Using the rich dataset offered by the {refugees} R package, this project sets out on an adventurous trip across the complicated landscape of worldwide migration from 2010 to 2022. It offers a comprehensive picture of the numerous factors influencing the lives of refugees, internally displaced people (IDPs), asylum seekers, stateless people, and more, spanning over 64,000 entries from sources like UNHCR, UNRWA, and IDMC. This research tries to unravel the complex web of variables driving forced migration, from socioeconomic turbulence to environmental calamities and geopolitical upheavals, via thorough investigation.

Two key topics form the core of our investigation: how changing political ideologies in the US affect refugee trends, and how changes in external occurrences such as pandemics, conflicts, and climate change affect refugee numbers globally. Using time-series analysis and additional statistical techniques, we examine displacement patterns and correlate them with major political changes and global crises in order to identify underlying trends and causal relationships.
In addition to tracking the rise and fall of international migration, this project aims to position these movements in the broader context of international politics, environmental issues, and global health concerns. Our objective is to present a comprehensive picture of the factors influencing worldwide migration patterns by integrating data on refugee movements with external socio-political and environmental events.
This study is essentially a deep dive into the dynamics of displacement, providing insights into how international events and policies affect vulnerable populations' movements. It serves as evidence of the interdependence of worldwide phenomena and their significant influence on human lives, highlighting the necessity of thoughtful, caring answers to the difficulties associated with forced migration.

## Introduction

This project analyses more than 64,000 data from the {refugees} R package, covering the period from 2010 to 2022, in order to investigate the intricate dynamics of worldwide displacement. The dataset provides a detailed look at the lives of refugees, internally displaced people (IDPs), asylum seekers, and stateless people, among others. It is derived from UNHCR, UNRWA, and IDMC and sheds light on the complex dynamics of forced migration. The goal is to identify the complex interactions that exist between outside variables and their impacts on patterns of global displacement, including geopolitical conflicts, natural disasters, and sociopolitical upheavals.

The impact of US political positions on refugee trends and the general changes in worldwide refugee populations as a result of external factors like wars, climatic shifts, and health crises like the COVID-19 pandemic are central to our research. We want to analyse the complex relationship between major world events and displacement trends using time-series analysis and statistical evaluations. This study aims to map out the ebb and flow of worldwide displacement while also placing these movements within the broader context of world events. This will help to better understand the forces driving migration, the interconnections of world events, and the effects these events have on displaced populations.


## Question 1: How have the patterns in refugee populations evolved over time, and how have the stances of American political parties impacted these developments? Analyse the dynamics of refugee migrations towards US political environments.

### Introduction

Our project's first inquiry explores the complex interplay between international refugee movements and political processes in the United States. We seek to understand how changes in political party ideologies and governmental positions inside the United States may have affected patterns of refugee populations, paying particular attention to historical data from 2000 to 2024. This investigation is based on the theory that political discourse and policy choices coming from the United States can significantly impact worldwide displacement patterns, either by reshaping the geopolitical environment or by changing the country's own refugee accepting policies.

### Approach

We have adopted a multimodal analytical approach to this subject, combining a comparative assessment of political epochs in the United States with time-series analysis. For clarity and scalability in our visual representations, we first aggregate the overall number of refugees by year, normalising the data to thousands. We can create a chronological narrative of refugee migrations by layering important political events and changes in the United States over these trends thanks to this basic data. We produce visual aids, such as bar plots and trend lines, using ggplot2 to clarify the relationship between refugee populations and changes in U.S. politics. Our research is further enhanced by the addition of data from returning refugees, which provides insights into the cyclical nature of displacement and resettlement.

**Data Preparation and Pre-processing**
The preparation stage of the data is essential to transforming our dataset into a format that allows for effective analysis. Using the R dplyr package, we first aggregate our data by year before summarising the overall number of refugeesâ€”making sure to divide these totals into thousands for easier comprehension. This procedure is also applied to data pertaining to refugees who have returned, yielding a parallel dataset that illustrates the flow of return movements in addition to original displacements. We also prepare by making the 'year' a numeric variable so that we can use it as an axis in both our static and animated visualisations. The careful processing of the data paves the way for an in-depth investigation of the relationship between U.S. political positions and international refugee trends.



```{r, message=FALSE, warning=FALSE}

# Data Preparation - Aggregate total number of refugees by year and convert to thousands (K)
total_refugee_trends <- population_data %>%
  group_by(year) %>%
  summarise(total_refugees = sum(refugees, na.rm = TRUE) / 1000)  # Convert to thousands

```
## Refugee populations over time.

```{r, message=FALSE, warning=FALSE}
# Plot: Total Refugee populations over time with bar plot and trend line, y-axis in 'K'
plot_total_refugees <- ggplot(total_refugee_trends, aes(x = year, y = total_refugees)) +
  geom_bar(stat = "identity", fill = "skyblue", alpha = 0.7) +  # Bar plot for yearly trends
  geom_smooth(method = "lm", formula = y ~ poly(x, 2), color = "#FF5230", se = FALSE) +  # Trend line for 30-year increase
  labs(title = "Total Refugee Populations Over Time", x = "Year", y = "Number of Refugees (in K)") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(from = min(total_refugee_trends$year), to = 2024, by = 1)) +  # Ensure all years from 2000 to 2024 are included
  scale_y_continuous(labels = scales::comma)  # Format y-axis labels with commas for readability

print(plot_total_refugees)


# Data Preparation - Aggregate total number of returned refugees by year and convert to thousands (K)
returned_refugee_trends <- population_data %>%
  group_by(year) %>%
  summarise(returned_refugees = sum(returned_refugees, na.rm = TRUE) / 1000)  # Convert to thousands

# Plot: Returned Refugee populations over time with bar plot and trend line, y-axis in 'K'
plot2 <- ggplot(returned_refugee_trends, aes(x = year, y = returned_refugees)) +
  geom_bar(stat = "identity", fill = "skyblue", alpha = 0.7) +  # Bar plot for yearly trends
  geom_smooth(method = "lm", formula = y ~ poly(x, 2), color = "#FF5230", se = FALSE) +  # Trend line for 30-year increase
  labs(title = "Returned Refugee Populations Over Time", x = "Year", y = "Number of Returned Refugees (in K)") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(from = min(returned_refugee_trends$year), to = 2024, by = 1)) +  # Ensure all years from 2000 to 2024 are included
  scale_y_continuous(labels = scales::comma)  # Format y-axis labels with commas for readability

print(plot2)


```


## Refugees by year and country of origin.

```{r, message=FALSE, warning=FALSE, echo=FALSE}

# Aggregate total number of refugees by year and country of origin
refugee_country_trends <- population_data %>%
  group_by(year, coo_name) %>%
  summarise(total_refugees = sum(refugees, na.rm = TRUE)) %>%
  ungroup()

# Identify the top 10 countries with the highest total number of refugees
top_countries <- refugee_country_trends %>%
  group_by(coo_name) %>%
  summarise(total_refugees = sum(total_refugees, na.rm = TRUE)) %>%
  top_n(20, total_refugees) %>%
  pull(coo_name)

# Filter the data to include only top 10 countries
top_country_data <- refugee_country_trends %>%
  filter(coo_name %in% top_countries)

# Select one of the top countries for demonstration
selected_country_data <- filter(top_country_data, coo_name == top_countries[1])

# Histogram: Distribution of refugee counts for a selected top country
# Aggregate the total number of refugees for each of the top 10 countries across all years
top_country_total_refugees <- refugee_country_trends %>%
  filter(coo_name %in% top_countries) %>%
  group_by(coo_name) %>%
  summarise(total_refugees = sum(total_refugees, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(desc(total_refugees))  # Arrange in descending order of total refugees

# Plot: Total number of refugees from top 10 countries
plot_top_countries <- ggplot(top_country_total_refugees, aes(x = reorder(coo_name, total_refugees), y = total_refugees)) +
  geom_bar(stat = "identity", fill = "purple") +  # Bar plot showing total refugees for each country
  labs(title = "Total Number of Refugees from Top 20 Countries", x = "Country of Origin", y = "Total Number of Refugees") +
  theme_minimal() +
  coord_flip() +  # Flip coordinates to make it easier to read country names
  scale_y_continuous(labels = scales::comma)  # Format y-axis labels with commas for readability

print(plot_top_countries)
# Adding US political context


#######################
# Aggregate total number of asylum seekers by year and country of asylum
asylum_country_trends <- population_data %>%
  group_by(year, coa_name) %>%
  summarise(total_asylum_seekers = sum(asylum_seekers, na.rm = TRUE)) %>%
  ungroup()

# Identify the top 20 countries with the highest total number of asylum seekers
top_asylum_countries <- asylum_country_trends %>%
  group_by(coa_name) %>%
  summarise(total_asylum_seekers = sum(total_asylum_seekers, na.rm = TRUE)) %>%
  top_n(20, total_asylum_seekers) %>%
  pull(coa_name)

# Filter the data to include only top 20 countries of asylum
top_asylum_country_data <- asylum_country_trends %>%
  filter(coa_name %in% top_asylum_countries)

# Aggregate the total number of asylum seekers for each of the top 20 countries across all years
top_country_total_asylum_seekers <- top_asylum_country_data %>%
  group_by(coa_name) %>%
  summarise(total_asylum_seekers = sum(total_asylum_seekers, na.rm = TRUE)) %>%
  ungroup() %>%
  arrange(desc(total_asylum_seekers))  # Arrange in descending order of total asylum seekers

# Plot: Total number of asylum seekers from top 20 countries
plot_top_asylum_countries <- ggplot(top_country_total_asylum_seekers, aes(x = reorder(coa_name, total_asylum_seekers), y = total_asylum_seekers)) +
  geom_bar(stat = "identity", fill = "blue") +  # Bar plot showing total asylum seekers for each country
  labs(title = "Total Number of Asylum Seekers from Top 20 Countries", x = "Country of Asylum", y = "Total Number of Asylum Seekers") +
  theme_minimal() +
  coord_flip() +  # Flip coordinates to make it easier to read country names
  scale_y_continuous(labels = scales::comma)  # Format y-axis labels with commas for readability

print(plot_top_asylum_countries)
```


## Refugee populations over time with US political context.

```{r, message=FALSE, warning=FALSE}

library(ggplot2)
library(dplyr)
library(readr)

# Load the dataset
population_data <- read_csv('data/population.csv')  

# Data Preparation - Aggregate total number of refugees by year
refugee_trends <- population_data %>%
  group_by(year) %>%
  summarise(total_refugees = sum(refugees, na.rm = TRUE))

# Adding US political context
# Define the political party in power for the given years
political_parties <- data.frame(
  year = c(2000, 2004, 2008, 2012, 2016, 2020),
  party = c("Republican", "Republican", "Democratic", "Democratic", "Republican", "Democratic"),
  stance = c("Positive", "Mixed", "Positive", "Positive", "Negative", "Positive")
)

# Merge this information with refugee trends
refugee_trends <- merge(refugee_trends, political_parties, by = "year", all.x = TRUE)

# Plot 2: Refugee populations over time with US political context
ggplot(refugee_trends, aes(x = year, y = total_refugees, color = party)) +
  geom_line() +
  geom_point(aes(shape = stance)) +
  scale_color_manual(values = c("Republican" = "red", "Democratic" = "blue")) +
  labs(title = "Refugee Populations and US Political Context", x = "Year", y = "Number of Refugees") +
  theme_minimal() +
  guides(color = guide_legend(title = "US Political Party"), shape = guide_legend(title = "US Policy Stance"))

```

## Question 2: How the global refugee population fluctuate across the countries? Is their any external factors impact on refugee population like COVID-19 or war or climate change or financial stability?

### Discussion

The visualizations offer a vivid depiction of the evolving global forest conversion patterns between `1990 and 2015`. Through color-coded maps, complex net forest conversion rates are presented in an easily understandable manner, facilitating the immediate recognition of trends. Darker shades representing significant deforestation or expansion immediately draw attention, guiding viewers to focus on countries undergoing substantial environmental changes. The animated visualizations highlight the dynamic nature of global forest conversion over the years across different countries.

The plot reveals significant changes in forest cover over recent decades, with unexpected rises observed in specific countries. Notable positive shifts occurred in the `2000s` and `2010s`, particularly in countries like the `USA`, `Russia`, `Australia`, `China`, and `India`. These improvements might be attributed to global deforestation awareness campaigns, leading to increased forest coverage in these nations. However, a significant portion of *South America* and *Africa* continues to bear the brunt of deforestation, with no signs of slowing down, particularly in countries like `Brazil` and `Tanzania`. Economically developed continents seem to prioritize reforestation initiatives, contrasting with less economically advantaged regions where such efforts receive comparatively less focus.

In conclusion, this visualization offers a compelling narrative of global environmental change, highlighting both challenges and successes in forest conservation efforts. It serves as a valuable tool for policymakers and environmentalists providing actionable insights into regional and global trends. Such visualizations can aid in targeted policy formulation, focusing resources where they are most needed, and fostering international collaborations to combat deforestation.

## References

Hannah Ritchie (2021) - "Forest area". Published online at OurWorldInData.org. Retrieved from: '[https://ourworldindata.org/forest-area'](https://ourworldindata.org/forest-area') \[Online Resource\]

Valdez, C. (2022). Brazil's Momentum as a Global Agricultural Supplier Faces Headwinds. Published online at ers.usda.gov. Retrieved from: [Economic Research Service](https://www.ers.usda.gov/amber-waves/2022/september/brazil-s-momentum-as-a-global-agricultural-supplier-faces-headwinds/)

Pagano, M. & Miransari, M. (2016). "The importance of soybean production worldwide." Retrieved from: [Science Direct](https://www.sciencedirect.com/science/article/pii/B9780128015360000013)

Song et al., (2021). "Massive soybean expansion in South America since 2000 and implications for conservation." Retrieved from: [National Library of Medicine](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8350977/#:~:text=Direct%20soybean%2Ddriven%20deforestation%20reached,forest%20loss%20during%20this%20period.)

Quarto, For documentation and presentation - [Quarto](https://quarto.org/docs/reference/formats/html.html)

ggplot, For understanding of different plot - [ggplot](https://ggplot2.tidyverse.org/reference/index.html)

Logo, The logo used in the webiste - [Online](https://pngtree.com/so/pandas)
